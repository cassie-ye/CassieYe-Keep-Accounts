{"remainingRequest":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\src\\views\\purchaseManagement\\purchaseRecords.vue?vue&type=style&index=0&id=088ffaa0&lang=scss&scoped=true","dependencies":[{"path":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\src\\views\\purchaseManagement\\purchaseRecords.vue","mtime":1733479377129},{"path":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\node_modules\\css-loader\\dist\\cjs.js","mtime":1733119317109},{"path":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1733119318739},{"path":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\node_modules\\postcss-loader\\src\\index.js","mtime":1733119317751},{"path":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1733119316648},{"path":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1733119316648},{"path":"E:\\myStudy\\guoyan\\JiangSu\\众彩\\南京众彩商户屏PC\\node_modules\\vue-loader\\lib\\index.js","mtime":1733119318248}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYXBwLWNvbnRhaW5lciB7CiAgLmRlbW8tZm9ybS1pbmxpbmUgewogICAgLmVsLWZvcm0taXRlbSB7CiAgICAgIG1hcmdpbi1yaWdodDogNDBweDsKICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDsKCiAgICAgIC5zZWFyY2gtYnRuIHsKICAgICAgICBtYXJnaW4tcmlnaHQ6IDZweDsKICAgICAgfQoKICAgICAgLnJlc2V0LWJ0biB7CiAgICAgICAgbWFyZ2luLXJpZ2h0OiA2cHg7CiAgICAgIH0KCiAgICAgIC5leHBvcnQtYnRuIHsKICAgICAgICBtYXJnaW4tdG9wOiA2cHg7CiAgICAgIH0KICAgIH0KICB9CgogIC8vIOaXpeacn+mAieaLqeWZqOagt+W8jwogIDpkZWVwKC5lbC1kYXRlLWVkaXRvcikgewogICAgbWFyZ2luLXRvcDogNnB4OwogIH0KfQoKLmVkaXQtaW5wdXQgewogIHBhZGRpbmctcmlnaHQ6IDEwMHB4Owp9CgouY2FuY2VsLWJ0biB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHJpZ2h0OiAxNXB4OwogIHRvcDogMTBweDsKfQoKLmRlbW8tZm9ybS1pbmxpbmUgewogIHdpZHRoOiAxMDAlOwoKICAuZWwtZm9ybS1pdGVtIHsKICAgIG1hcmdpbi1yaWdodDogMzBweDsKCiAgICAuZWwtaW5wdXQgewogICAgICB3aWR0aDogMjUwcHg7CiAgICAgIG1hcmdpbi10b3A6IDZweDsKICAgIH0KICB9Cgp9CgouYnV0dG9uLWdyb3VwIHsKCiAgLnNlYXJjaC1idG4sCiAgLmV4cG9ydC1idG4gewogICAgYmFja2dyb3VuZC1jb2xvcjogIzJmNThlMzsKICAgIGJvcmRlcjogIzJmNThlMzsKICB9CgogIC5yZXNldC1idG4gewogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmMjcyNzsKICAgIGJvcmRlcjogI2ZmMjcyNzsKICB9CgogIC5lbC1idXR0b24gewogICAgbWFyZ2luLXJpZ2h0OiAxMHB4OwogICAgcGFkZGluZy1sZWZ0OiAzMHB4OwogICAgcGFkZGluZy1yaWdodDogMzBweDsKICAgIGJvcmRlci1yYWRpdXM6IDJweDsKICB9Cn0K"},{"version":3,"sources":["purchaseRecords.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyOA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"purchaseRecords.vue","sourceRoot":"src/views/purchaseManagement","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form :inline=\"true\" :model=\"formData.formInline\" class=\"demo-form-inline\">\n      <el-form-item class=\"el-form-item\" label=\"摊位号：\">\n        <el-input v-model=\"formData.formInline.stallNo\" placeholder=\"输入搜索关键词\" />\n      </el-form-item>\n      <el-form-item class=\"el-form-item\" label=\"采购商手机号：\">\n        <el-input v-model=\"formData.formInline.purchaserPhoneNumber\" placeholder=\"输入搜索关键词\" />\n      </el-form-item>\n      <el-form-item class=\"el-form-item\" label=\"商户名称：\">\n        <el-input v-model=\"formData.formInline.businessName\" placeholder=\"输入搜索关键词\" />\n      </el-form-item>\n      <el-form-item class=\"el-form-item\" label=\"商品名称：\">\n        <el-input v-model=\"formData.formInline.goodsName\" placeholder=\"输入搜索关键词\" />\n      </el-form-item>\n      <el-form-item class=\"el-form-item\" label=\"采购时间：\">\n        <el-date-picker\n          v-model=\"formData.formInline.purchaseTime\"\n          format=\"yyyy-MM-dd\"\n          type=\"daterange\"\n          start-placeholder=\"开始日期\"\n          end-placeholder=\"结束日期\"\n          style=\"margin-top: 6px;\"\n        />\n      </el-form-item>\n      <el-form-item class=\"button-group\">\n        <el-button type=\"primary\" class=\"search-btn\" @click=\"onSearch\">搜索</el-button>\n        <el-button type=\"primary\" class=\"reset-btn\" @click=\"onReset\">重置</el-button>\n        <el-button type=\"primary\" class=\"export-btn\" @click=\"onExport\">导出</el-button>\n      </el-form-item>\n    </el-form>\n    <el-table\n      v-loading=\"listLoading\"\n      :data=\"recordsList\"\n      border\n      fit\n      highlight-current-row\n      style=\"width: 100%;margin-top: 15px;\"\n    >\n      <el-table-column label=\"采购时间\">\n        <template slot-scope=\"scope\">\n          <span style=\"font-size: 15px; color: #999999;\">{{ scope.row.dealTime || \"暂无\" }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"采购商手机号\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.buyerMobileNo || \"暂无\" }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column label=\"摊位号\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.boothNo || \"暂无\" }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column label=\"商户名称\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.proprietorName || \"暂无\" }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column label=\"商品名称\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.goodsName || \"暂无\" }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"采购量\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.goodsWeight + scope.row.unit || \"暂无\" }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"text\" @click=\"openOperateDialog(scope.row)\">食安链条</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <foodSafetyChain v-if=\"infoVisible\" ref=\"info\" />\n    <el-pagination\n      style=\"margin-top: 20px;\"\n      :current-page=\"formData.page\"\n      :page-sizes=\"[10, 20, 50, 100]\"\n      :page-size=\"formData.limit\"\n      :total=\"total\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n      @size-change=\"sizeChangeHandle\"\n      @current-change=\"currentChangeHandle\"\n    />\n  </div>\n</template>\n\n<script>\nimport dayjs from 'dayjs'\nimport XLSX from 'xlsx'\nimport FileSaver from 'file-saver'\nimport { getPurchaseRecordsManagementListAPI } from '@/api/purchaseManagement'\nimport foodSafetyChain from './foodSafetyChain'\nexport default {\n  name: 'ArticleList',\n  components: {\n    foodSafetyChain\n  },\n  data() {\n    return {\n      total: 0,\n      listLoading: true,\n      infoVisible: false,\n      recordsList: [],\n      formData: {\n        page: 1,\n        limit: 10,\n        formInline: {\n          // 摊位号\n          stallNo: '',\n          // 采购商手机号\n          purchaserPhoneNumber: '',\n          // 商户名称\n          businessName: '',\n          // 商品名称\n          goodsName: '',\n          // 采购时间\n          purchaseTime: null\n        }\n      }\n    }\n  },\n  created() {\n    this.getPurchaseRecordsManagementList()\n  },\n  methods: {\n    getPurchaseRecordsManagementList() {\n      this.listLoading = true\n      let dealTimeStart = ''\n      let dealTimeEnd = ''\n      if (this.formData.formInline.purchaseTime && this.formData.formInline.purchaseTime.length === 2) {\n        const [startDate, endDate] = this.formData.formInline.purchaseTime\n        dealTimeStart = dayjs(startDate).format('YYYY-MM-DD')\n        dealTimeEnd = dayjs(endDate).format('YYYY-MM-DD')\n      }\n      const params = {\n        limit: this.formData.limit,\n        page: this.formData.page,\n        boothNo: this.formData.formInline.stallNo,\n        buyerMobileNo: this.formData.formInline.purchaserPhoneNumber,\n        dealTimeStart,\n        dealTimeEnd,\n        goodsName: this.formData.formInline.goodsName,\n        proprietorName: this.formData.formInline.businessName\n      }\n      getPurchaseRecordsManagementListAPI(params).then(res => {\n        this.recordsList = res.data\n        this.total = Number(res.count)\n        this.listLoading = false\n      })\n    },\n    openOperateDialog(row) {\n      this.infoVisible = true\n      this.$nextTick(() => {\n        this.$refs.info.init(row.goodsDealDetailId)\n      })\n    },\n    sizeChangeHandle(val) {\n      this.formData.limit = val\n      this.formData.page = 1\n      this.getPurchaseRecordsManagementList()\n    },\n    currentChangeHandle(val) {\n      this.formData.page = val\n      this.getPurchaseRecordsManagementList()\n    },\n    onSearch() {\n      this.formData.page = 1\n      this.formData.limit = 10\n      this.getPurchaseRecordsManagementList()\n    },\n    onReset() {\n      this.formData.formInline.stallNo = ''\n      this.formData.formInline.purchaserPhoneNumber = ''\n      this.formData.formInline.businessName = ''\n      this.formData.formInline.goodsName = ''\n      this.formData.formInline.purchaseTime = null\n      this.getPurchaseRecordsManagementList()\n    },\n    onExport() {\n      const params = {\n        limit: 999999,\n        page: 1,\n        boothNo: '',\n        buyerMobileNo: '',\n        dealTimeStart: '',\n        dealTimeEnd: '',\n        goodsName: '',\n        proprietorName: ''\n      }\n      getPurchaseRecordsManagementListAPI(params).then(res => {\n        if (res.code === 0 && res.data) {\n          const exportData = res.data.map(item => {\n            return {\n              '采购时间': item.dealTime,\n              '采购商手机号': item.buyerMobileNo,\n              '摊位号': item.boothNo,\n              '商户名称': item.proprietorName,\n              '商品名称': item.goodsName,\n              '采购量': item.goodsWeight + item.unit\n            }\n          })\n          this.generateExcel(exportData)\n        } else {\n          this.$message.error('导出失败')\n        }\n      })\n    },\n    generateExcel(exportData) {\n      const wb = XLSX.utils.book_new()\n      const ws = XLSX.utils.json_to_sheet(exportData)\n      const wscols = [{ wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }, { wch: 30 }]\n      ws['!cols'] = wscols\n      XLSX.utils.book_append_sheet(wb, ws, '采购记录导出')\n      const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' })\n      const buf = new ArrayBuffer(wbout.length)\n      const view = new Uint8Array(buf)\n      for (let i = 0; i < wbout.length; i++) {\n        view[i] = wbout.charCodeAt(i) & 0xFF\n      }\n      const blob = new Blob([buf], { type: 'application/octet-stream' })\n      FileSaver.saveAs(blob, '采购记录导出.xlsx')\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.app-container {\n  .demo-form-inline {\n    .el-form-item {\n      margin-right: 40px;\n      margin-bottom: 10px;\n\n      .search-btn {\n        margin-right: 6px;\n      }\n\n      .reset-btn {\n        margin-right: 6px;\n      }\n\n      .export-btn {\n        margin-top: 6px;\n      }\n    }\n  }\n\n  // 日期选择器样式\n  :deep(.el-date-editor) {\n    margin-top: 6px;\n  }\n}\n\n.edit-input {\n  padding-right: 100px;\n}\n\n.cancel-btn {\n  position: absolute;\n  right: 15px;\n  top: 10px;\n}\n\n.demo-form-inline {\n  width: 100%;\n\n  .el-form-item {\n    margin-right: 30px;\n\n    .el-input {\n      width: 250px;\n      margin-top: 6px;\n    }\n  }\n\n}\n\n.button-group {\n\n  .search-btn,\n  .export-btn {\n    background-color: #2f58e3;\n    border: #2f58e3;\n  }\n\n  .reset-btn {\n    background-color: #ff2727;\n    border: #ff2727;\n  }\n\n  .el-button {\n    margin-right: 10px;\n    padding-left: 30px;\n    padding-right: 30px;\n    border-radius: 2px;\n  }\n}\n</style>\n"]}]}